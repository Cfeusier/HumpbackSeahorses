<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <link rel='stylesheet' src="/client/style.css">
  </head>
  
  <h1>Welcome to HumpbackSeahorses</h1>

    <div id="submitView">
    <form action="">
      <input id="room" placeholder='room' autocomplete="off" />
      <input id="lang" placeholder='lang' autocomplete="off" />
      <input id="username" placeholder='username' autocomplete="off" />
        <input id="chatInput" placeholder='message' autocomplete="off" /><button>Send</button>
      </form>
    </div>

    <div id="messagesView"> </div>
    <script src="/dist/scripts.min.js"></script>
    <script>
      $('#room').change(function(){
        socket.emit('leave room', currentRoom);
        currentRoom = $('#room').val();
        socket.emit('join room', currentRoom);
      });
      var socket = io();
      var currentRoom = 'lobby';
      $('form').submit(function(){
        var message = {
          text: $('#m').val(),
          lang: $('#lang').val(),
          username: $('#username').val(),
          room: $('#room').val()
        };
        console.log('message si ->', message);  
        socket.emit('chat message', message);
        $('#m').val('');
        return false;
      });
      socket.on('chat message', function(msg){
        $('#messages').append($('<li>').text(msg.username + '@' + msg.room + ' - ' + msg.text));
      });
    </script>
  </body>
</html>

